
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/twist-gaming/carrot-math-engine/fe_assets/fe_readme/">
      
      
        <link rel="prev" href="../../optimization_section/optimization_algorithm/">
      
      
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>Frontend Documentation - Carrot Math Engine</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d7758b05.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather+Sans:300,300i,400,400i,700,700i%7CRed+Hat+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Merriweather Sans";--md-code-font:"Red Hat Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#carrot-game-sdk" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Carrot Math Engine" class="md-header__button md-logo" aria-label="Carrot Math Engine" data-md-component="logo">
      
  <img src="../../assets/carrot.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Carrot Math Engine
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Frontend Documentation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-purple"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Carrot Math Engine" class="md-nav__button md-logo" aria-label="Carrot Math Engine" data-md-component="logo">
      
  <img src="../../assets/carrot.png" alt="logo">

    </a>
    Carrot Math Engine
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../general_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Engine Setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    High-Level Structure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            High-Level Structure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview_section/state_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State Machine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview_section/game_struct/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Game Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview_section/game_format/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Game Format
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gamestate Structure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Gamestate Structure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gamestate_section/repeat_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulation Acceptance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gamestate_section/configuration_section/config_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gamestate_section/configuration_section/betmode_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BetMode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gamestate_section/configuration_section/betmode_dist/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distribution
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Symbols and Board
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Symbols and Board
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gamestate_section/syms_board_section/symbol_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Symbols
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gamestate_section/syms_board_section/board_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Board
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gamestate_section/win_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gamestate_section/events_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Events
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gamestate_section/force_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Force Files
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Source Files
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Source Files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Calculations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Calculations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_section/board_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Board
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_section/tumble_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tumble
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_section/lines_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_section/ways_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ways
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_section/scatter_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scatter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_section/cluster_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_section/config_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_section/event_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Events
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_section/executables_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Executables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_section/state_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_section/win_manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Win Manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../source_section/file_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outputs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils_section/utilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utilities[NA]
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sample_section/sample_games/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example Games
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../uploads_section/upload_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Uploads [NA]
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tests_section/test_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tests [NA]
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization_section/optimization_algorithm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimization Algorithm
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Frontend Documentation
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Frontend Documentation
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-started" class="md-nav__link">
    <span class="md-ellipsis">
      Get started
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Get started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#explore-storybook" class="md-nav__link">
    <span class="md-ellipsis">
      Explore Storybook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Explore Storybook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flow-chart" class="md-nav__link">
    <span class="md-ellipsis">
      Flow Chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bookevent" class="md-nav__link">
    <span class="md-ellipsis">
      BookEvent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#emitterevent" class="md-nav__link">
    <span class="md-ellipsis">
      EmitterEvent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-breakdown" class="md-nav__link">
    <span class="md-ellipsis">
      Task Breakdown
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#new-bookevent-steps-to-implement-and-test" class="md-nav__link">
    <span class="md-ellipsis">
      New BookEvent: Steps to Implement and Test
    </span>
  </a>
  
    <nav class="md-nav" aria-label="New BookEvent: Steps to Implement and Test">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to-be-continued" class="md-nav__link">
    <span class="md-ellipsis">
      To Be Continued
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-started" class="md-nav__link">
    <span class="md-ellipsis">
      Get started
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Get started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#explore-storybook" class="md-nav__link">
    <span class="md-ellipsis">
      Explore Storybook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Explore Storybook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flow-chart" class="md-nav__link">
    <span class="md-ellipsis">
      Flow Chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bookevent" class="md-nav__link">
    <span class="md-ellipsis">
      BookEvent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#emitterevent" class="md-nav__link">
    <span class="md-ellipsis">
      EmitterEvent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-breakdown" class="md-nav__link">
    <span class="md-ellipsis">
      Task Breakdown
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#new-bookevent-steps-to-implement-and-test" class="md-nav__link">
    <span class="md-ellipsis">
      New BookEvent: Steps to Implement and Test
    </span>
  </a>
  
    <nav class="md-nav" aria-label="New BookEvent: Steps to Implement and Test">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to-be-continued" class="md-nav__link">
    <span class="md-ellipsis">
      To Be Continued
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="carrot-game-sdk">Carrot Game SDK</h1>
<p>This is a web game engine powered by Svelte 5, PixiJS 8 and TurboRepo.</p>
<h2 id="dependencies">Dependencies</h2>
<p>Besides basic web skills (html, css and javascript), here it shows a list of npm dependencies of this repo. It would be great to start with understanding them before kicking off <a href="#getStarted">Get Started</a>.</p>
<ul>
<li>pixijs: https://www.npmjs.com/package/pixi.js and <a href="https://pixijs.download/release/docs/index.html">more...</a></li>
<li>svelte: https://www.npmjs.com/package/svelte and <a href="https://svelte.dev/docs/svelte/overview">more...</a></li>
<li>turborepo: https://www.npmjs.com/package/turbo and <a href="https://turbo.build/repo/docs">more...</a></li>
<li>pixi-svelte: https://www.npmjs.com/package/pixi-svelte and <a href="https://github.com/qk0106/pixi-svelte-storybook">more...</a></li>
<li>This is an in-house package. It combines pixi and svelte together and uses pixijs in a declarative way.</li>
<li>sveltekit: https://www.npmjs.com/package/@sveltejs/kit and <a href="https://svelte.dev/docs/kit/introduction">more...</a></li>
<li>storybook: https://www.npmjs.com/package/storybook and <a href="https://storybook.js.org/tutorials/intro-to-storybook/svelte/en/get-started/">more...</a></li>
<li>xstate: https://www.npmjs.com/package/xstate and <a href="https://stately.ai/docs/">more...</a></li>
<li>typescript: https://www.npmjs.com/package/typescript and <a href="https://www.typescriptlang.org/docs/">more...</a></li>
<li>pnpm: https://www.npmjs.com/package/pnpm and <a href="https://pnpm.io/installation">more...</a></li>
</ul>
<h2 id="get-started"><a name="getStarted"></a>Get started</h2>
<p>Here is a complete tutorial to start our sample games in the storybook. Please ignore those steps that you already know or done.</p>
<ul>
<li>It is preferred to use VS Code as IDE. <a href="https://code.visualstudio.com/download">download</a></li>
<li>Install node with version 18.18.0. <a href="https://nodejs.org/en/download">download</a></li>
</ul>
<pre><code># Download and install nvm:
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.1/install.sh | bash

# in lieu of restarting the shell
\. &quot;$HOME/.nvm/nvm.sh&quot;

# Download and install Node.js:
nvm install 18.18.0

# Verify the node versions. Should print &quot;v18.18.0&quot;.
node -v
</code></pre>
<ul>
<li>Install pnpm with version 10.5.0.</li>
</ul>
<pre><code># Install pnpm
npm install pnpm@10.5.0 -g

# Verify the pnpm versions. Should print &quot;v10.5.0&quot;
pnpm -v
</code></pre>
<ul>
<li>Clone the repo to your local in VS Code terminal or others.</li>
</ul>
<pre><code>git clone https://github.com/twist-gaming/carrot-game-sdk.git
cd carrot-game-sdk
</code></pre>
<ul>
<li>Install dependencies.</li>
</ul>
<pre><code>pnpm install
</code></pre>
<ul>
<li>Run <code>pnpm run storybook --filter=&lt;MODULE_NAME&gt;</code> to storybook of a sample game in a turborepo way. <code>&lt;MODULE_NAME&gt;</code> is the name in the package.json file of a module in apps and packages folders. For example, we have <code>"name": "lines"</code> in the apps/lines/package.json, so we can find it and run its storybook by:</li>
</ul>
<pre><code>pnpm run storybook --filter=lines
</code></pre>
<ul>
<li>You should see this:</li>
</ul>
<p><img alt="" src="../storybook_init.png" /></p>
<!-- <img src="storybook_init.png" alt="isolated" width="100%"/> -->

<h3 id="_1"></h3>
<ul>
<li>Now switch to MODE_BASE/book/random in the left sidebar, you will see an <code>Action</code> button appear on the left right conner of the game.</li>
</ul>
<p><img alt="" src="../storybook_action.png" /></p>
<!-- <img src="storybook_action.png" alt="isolated" width="100%"/> -->

<h3 id="_2"></h3>
<ul>
<li>Click on the <code>Action</code> button and wait for a base game to finish.</li>
<li>Congratulations! You are now in the zone of game development with us.</li>
</ul>
<h2 id="explore-storybook">Explore Storybook</h2>
<p>Storybook is a powerful and handy tool to test your games. For example:</p>
<ul>
<li><code>MODE_BASE/book/random</code>: It tests the <Game \/> component with a random book of base mode.</li>
<li><code>MODE_BASE/bookEvent/reveal</code>: It tests the <Game \/> component with a "reveal" bookEvent of the base mode. It will spin the reels.</li>
<li><code>MODE_BONUS/book/random</code>: It tests the <Game \/> component with a random book of bonus mode.</li>
<li><code>MODE_BONUS/bookEvent/reveal</code>: It tests the <Game \/> component with a "reveal" bookEvent of the bonus mode. It will spin the reels.</li>
<li>...</li>
<li><code>COMPONENTS/&lt;GAME&gt;/component</code>: It tests the <Game \/> component. In this case, it doesn't skip the loading screen.</li>
<li><code>COMPONENTS/&lt;GAME&gt;/preSpin</code>: It tests the <Game \/> component with the preSpin function.</li>
<li><code>COMPONENTS/&lt;GAME&gt;/emitterEvent</code>: It tests the <Game \/> component with an emitterEvent "boardHide".</li>
<li>...</li>
<li><code>COMPONENTS/&lt;Symbol&gt;/component</code>: It tests the <Symbol \/> component with controls e.g. state of the symbol.</li>
<li><code>COMPONENTS/&lt;Symbol&gt;/symbols</code>: It tests the <Symbol \/> component with all the symbols and all the states.</li>
</ul>
<p><img alt="" src="../storybook_symbol.png" />
<img alt="" src="../storybook_symbols.png" /></p>
<!-- <img src="storybook_symbol.png" alt="isolated" width="100%"/> -->
<!-- <img src="storybook_symbols.png" alt="isolated" width="100%"/> -->

<h3 id="_3"></h3>
<p>With all the above stories and the stories you create and customise by yourself, it is able to test the game as a whole, intermediate components or atomic components. It is also able to test your game with a book, a sequence of bookEvents or a single bookEvent. If each bookEvent is implemented well with emitterEvents and its story is resolved properly, the game is almost finished.</p>
<h2 id="flow-chart">Flow Chart</h2>
<p>Here it is a simplified flow chart of steps how a game is processed after RGS request. The real situation might be more complicated, but it follows the same idea.</p>
<p><img alt="" src="../flow_chart.png" /></p>
<!-- <img src="flow_chart.png" alt="isolated" width="100%"/> -->

<ul>
<li>
<p><code>playBookEvents()</code>: This is a function that's created by <code>createPlayBookUtils()</code> from <code>packages/utils-book</code>. What it does is to go through bookEvents one by one, handle each with async function (<code>playBookEvent()</code>) and resolve them one after another (<code>sequence()</code>) with the order of the bookEvents array.</p>
</li>
<li>
<p>That means the order of bookEvents matters and it determines the order of the game. For example, we don't wanna see the "win" before "spin", so we should put "win" after the "spin". This function is also used in the <code>MODE_XXX/book/random</code> stories.</p>
</li>
<li>
<p><code>sequence()</code>: This is an in-house async function to achieve resolving async functions/promises one after another. On the contrast, <code>Promise.all()</code> will trigger all the async functions/promises together at the same time, which is not what we desire for the sequence of the game.</p>
</li>
<li>
<p><code>playBookEvent()</code>: This is a function that takes in a bookEvent with some context (usually all the bookEvents), then find the bookEventHandler in bookEventHandlerMap based on <code>bookEvent.type</code> to process it. This function is also used in the <code>MODE_XXX/bookEvent/xxx</code> stories.</p>
</li>
</ul>
<pre><code>const playBookEvents = async (
  bookEvents: TBookEvent[],
  bookEventContext?: BookEventContextFromMapWithoutBookEvents,
) =&gt; {
  const finalBookEventContext =
    bookEventContext || ({} as BookEventContextFromMapWithoutBookEvents);

  await sequence(bookEvents, async (bookEvent) =&gt; {
    await playBookEvent(bookEvent, { ...finalBookEventContext, bookEvents });
  });
};
</code></pre>
<h2 id="bookevent">BookEvent</h2>
<ul>
<li><code>Book</code>: A book is a json data that is returned from the RGS (Remote Game Server) for each game requested. It is randomly picked from over a million of books, which we call it <a href="https://twist-gaming.github.io/carrot-math-engine">math</a>.</li>
</ul>
<pre><code>// Example of a base game book
{
  id: 1,
  payoutMultiplier: 0.0,
  events: [
    {
      index: 0,
      type: 'reveal',
      board: [
        [{ name: 'L2' }, { name: 'L1' }, { name: 'L4' }, { name: 'H2' }, { name: 'L1' }],
        [{ name: 'H1' }, { name: 'L5' }, { name: 'L2' }, { name: 'H3' }, { name: 'L4' }],
        [{ name: 'L3' }, { name: 'L5' }, { name: 'L3' }, { name: 'H4' }, { name: 'L4' }],
        [{ name: 'H4' }, { name: 'H3' }, { name: 'L4' }, { name: 'L5' }, { name: 'L1' }],
        [{ name: 'H3' }, { name: 'L3' }, { name: 'L3' }, { name: 'H1' }, { name: 'H1' }],
      ],
      paddingPositions: [216, 205, 195, 16, 65],
      gameType: 'basegame',
      anticipation: [0, 0, 0, 0, 0],
    },
    { index: 1, type: 'setTotalWin', amount: 0 },
    { index: 2, type: 'finalWin', amount: 0 },
  ],
  criteria: '0',
  baseGameWins: 0.0,
  freeGameWins: 0.0,
}
</code></pre>
<ul>
<li><code>BookEvent</code>: A bookEvent is a json data that is one of the element of the <code>book.events</code> array.</li>
</ul>
<pre><code>// Example of a &quot;reveal&quot; bookEvent
{
  index: 0,
  type: 'reveal',
  board: [
    [{ name: 'L2' }, { name: 'L1' }, { name: 'L4' }, { name: 'H2' }, { name: 'L1' }],
    [{ name: 'H1' }, { name: 'L5' }, { name: 'L2' }, { name: 'H3' }, { name: 'L4' }],
    [{ name: 'L3' }, { name: 'L5' }, { name: 'L3' }, { name: 'H4' }, { name: 'L4' }],
    [{ name: 'H4' }, { name: 'H3' }, { name: 'L4' }, { name: 'L5' }, { name: 'L1' }],
    [{ name: 'H3' }, { name: 'L3' }, { name: 'L3' }, { name: 'H1' }, { name: 'H1' }],
  ],
  paddingPositions: [216, 205, 195, 16, 65],
  gameType: 'basegame',
  anticipation: [0, 0, 0, 0, 0],
}

// Example of a setTotalWin bookEvent
{ index: 1, type: 'setTotalWin', amount: 0 },
</code></pre>
<ul>
<li>
<p><code>BookEventHandler</code>: An async function that takes in a bookEvent and do some operations with it. Usually it broadcasts some emitterEvents, so the components will handle.</p>
</li>
<li>
<p><code>bookEventHandlerMap</code>: An object that the key is <code>bookEvent.type</code> and value is a bookEventHandler. We can find this big-boy object in <code>src/game/bookEventHandlerMap.ts</code>.</p>
</li>
</ul>
<pre><code>// Example of &quot;updateFreeSpin&quot; bookEventHandler
export const bookEventHandlerMap: BookEventHandlerMap&lt;BookEvent, BookEventContext&gt; = {
  ...,
  updateFreeSpin: async (bookEvent: BookEventOfType&lt;'updateFreeSpin'&gt;) =&gt; {
    stateApp.eventEmitter.next({ type: 'freeSpinCounterShow' });
    stateApp.eventEmitter.next({
      type: 'freeSpinCounterUpdate',
      current: bookEvent.amount,
      total: bookEvent.total,
    });
  },
  ...,
}
</code></pre>
<ul>
<li>In simple terms, a book is composed by multiple bookEvents. Different combinations of bookEvents will determine the different behaviours of a game e.g. win/lose, a big/small win, a base/bonus game, 1/10/15 spins and so on.</li>
</ul>
<h2 id="emitterevent">EmitterEvent</h2>
<ul>
<li><code>EmitterEvent</code>: An emitterEvent is a json data that <code>stateApp.eventEmitter.next(emitterEvent)</code> or <code>stateApp.eventEmitter.asyncNext(emitterEvent)</code> broadcasts, so that a component which has <code>stateApp.eventEmitter.registerOnMount(emitterEventHandlerMap)</code> can receive the data and deal with it in a synchronous or asynchronous way. For a game we have many animations, so sometimes we need to "await" for those animations to finish before going to the next step.</li>
</ul>
<pre><code>// Example of an emitterEvent
{
  type: 'freeSpinCounterUpdate',
  current: undefined,
  total: bookEvent.totalFs,
}
</code></pre>
<ul>
<li><code>EmitterEventHandler (Synchronous)</code>: A sync function that takes in an emitterEvent. It usually deal with some sync operations e.g. show/hide component, tidy up, update some numbers and so on.</li>
</ul>
<pre><code>// Example of broadcasting
stateApp.eventEmitter.next({
  type: 'freeSpinCounterUpdate',
  current: undefined,
  total: bookEvent.totalFs,
});

// Example of receiving
context.stateApp.eventEmitter.registerOnMount({
  // emitterEventHandlerMap
  ...,
  freeSpinCounterUpdate: (emitterEvent) =&gt; {
    if (emitterEvent.current !== undefined) current = emitterEvent.current;
    if (emitterEvent.total !== undefined) total = emitterEvent.total;
  },
  ...,
});
</code></pre>
<ul>
<li><code>EmitterEventHandler (Asynchronous)</code>: An async function that takes in an emitterEvent. It usually deal with some async operations e.g. wait for fading in/out component, wait for animations to finish, wait for numbers to increase/decrease with <a href="https://svelte.dev/docs/svelte/svelte-motion#Tween">Tween</a> and so on.</li>
</ul>
<pre><code>// Example of broadcasting
await stateApp.eventEmitter.asyncNext({
  type: 'freeSpinIntroUpdate',
  totalFreeSpins: bookEvent.totalFs,
});

// Example of receiving
context.stateApp.eventEmitter.registerOnMount({
  // emitterEventHandlerMap
  ...,
  freeSpinIntroUpdate: async (emitterEvent) =&gt; {
    freeSpinsFromEvent = emitterEvent.totalFreeSpins;
    await waitForResolve((resolve) =&gt; (oncomplete = resolve)); // Wait for an animation to finish.
  },
  ...,
});
</code></pre>
<ul>
<li><code>emitterEventHandlerMap</code>: An object that the key is <code>emitterEvent.type</code> and value is an emitterEventHandler. We can find this object in each component. For example, <code>src/components/FreeSpinCounter.svelte</code>.</li>
<li>Each emitterEventHandler can do a lot or a little, but we prefer each emitterEventHandler just doing a minimum job to achieve the duty that's described by its name. This way we follow the single responsibility principle of <a href="https://www.digitalocean.com/community/conceptual-articles/s-o-l-i-d-the-first-five-principles-of-object-oriented-design#single-responsibility-principle">SOLID</a>. For example, <code>freeSpinCounterShow</code> just shows this component and does nothing more.</li>
</ul>
<pre><code>// Example of FreeSpinCounter.svelte and its emitterEventHandlers
&lt;script lang=&quot;ts&quot; module&gt;
  export type FreeSpinCounterEmitterEvent =
    | { type: 'freeSpinCounterShow' }
    | { type: 'freeSpinCounterHide' }
    | { type: 'freeSpinCounterUpdate'; current?: number; total?: number };
&lt;/script&gt;

&lt;script lang=&quot;ts&quot;&gt;
  ...

  context.stateApp.eventEmitter.registerOnMount({
    // emitterEventHandlerMap
    freeSpinCounterShow: () =&gt; (show = true),
    freeSpinCounterHide: () =&gt; (show = false),
    freeSpinCounterUpdate: (emitterEvent) =&gt; {
      if (emitterEvent.current !== undefined) current = emitterEvent.current;
      if (emitterEvent.total !== undefined) total = emitterEvent.total;
    },
  });
&lt;/script&gt;

&lt;MainContainer&gt;
  ...
&lt;/MainContainer&gt;
</code></pre>
<h2 id="task-breakdown">Task Breakdown</h2>
<ul>
<li>If an emitterEventHandler does too much work, then it's better we consider to split it into smaller emitterEventHandlers as a process of task-breakdown. For example, "tumbleBoard" bookEvent is a fairly complicated bookEvent. Instead of having one "tumbleBoard" emitterEvent, we split it into "tumbleBoardInit", "tumbleBoardExplode", "tumbleBoardRemoveExploded", "tumbleBoardSlideDown". This way we can implement a complicated emitterEvent step by step and more importantly, we can test the implementations one by one in storybook.</li>
</ul>
<pre><code>// Example of TumbleBoard.svelte and task-breakdown
context.stateApp.eventEmitter.registerOnMount({
  // emitterEventHandlerMap
  tumbleBoardShow: () =&gt; {},
  tumbleBoardHide: () =&gt; {},
  tumbleBoardInit: () =&gt; {},
  tumbleBoardReset: () =&gt; {},
  tumbleBoardExplode: () =&gt; {},
  tumbleBoardRemoveExploded: () =&gt; {},
  tumbleBoardSlideDown: () =&gt; {},
});
</code></pre>
<ul>
<li>Now it's easy to tell that, there's one single idea that's been applied across the whole carrot-game-sdk which is <code>Task Breakdown</code>. Stateless games can be complicated with different types of spins, number of spins, win rules, number of bookEvents, game modes, global multiplier, multiplier symbols and so on. However with the data structure of math and the in-house functions we have, we are able to break down a game into small tasks/emitterEvents as atomic pieces of code. It enables us to test the atomics independently as well. Visually it's something like this:</li>
</ul>
<p><img alt="" src="../task_breakdown.png" /></p>
<!-- <img src="task_breakdown.png" alt="isolated" width="100%"/> -->

<h2 id="new-bookevent-steps-to-implement-and-test">New BookEvent: Steps to Implement and Test</h2>
<ul>
<li>
<p><code>New BookEvent</code>: Assume that you have a game already and you have added a new bookEvent <code>updateGlobalMult</code> to the bonus game mode (<code>MODE_BONUS</code>) in math, here we will go through the steps together to implement the new bookEvent and add it to the game. Along the way we will introduce part of our file structure as well.</p>
</li>
<li>
<p><code>src/stories/data/bonus_books.ts</code>: This file includes the an array of bonus books that story <code>MODE_BONUS/book/random</code> will randomly pick at. This is to simulate requesting data from RGS. All we need to do is to copy/paste data from our new math package and format it.</p>
</li>
</ul>
<pre><code>// Example of &quot;updateGlobalMult&quot; bookEvent. That's been added in our `bonus_books.ts` during generating math.
{
  type: 'updateGlobalMult',
  globalMult: 3,
},
</code></pre>
<ul>
<li><code>src/stories/data/bonus_events.ts</code>: This file includes the an object of every type of bookEvent that story <code>MODE_BONUS/bookEvent/xxx</code> uses. All we need to do is to copy/paste data from our new math package and format it.</li>
</ul>
<pre><code>export default {
  ...,
  updateGlobalMult: {
    type: 'updateGlobalMult',
    globalMult: 3,
  },
  ...,
}
</code></pre>
<ul>
<li><code>src/stories/ModeBaseBookEvent.stories.svelte</code>: This file implements all the sub stories in story <code>MODE_BONUS/book/updateGlobalMult</code>. With the following code added in this file, you will see the a new story <code>MODE_BONUS/book/updateGlobalMult</code> that's added in our storybook with an <code>Action</code> button. Now if we click on it and nothing would happen, but it's a good start because we set up the testing environment first. Next step is to add code of bookEventHandler to handle it.</li>
</ul>
<pre><code>&lt;Story
  name=&quot;updateGlobalMult&quot;
  args={templateArgs({
    skipLoadingScreen: true,
    data: events.updateGlobalMult,
    action: async (data) =&gt; await playBookEvent(data, { bookEvents: [] }),
  })}
/&gt;
</code></pre>
<ul>
<li><code>src/game/typesBookEvent.ts</code>: This file contains typescript types of all the bookEvents. Let's add the type of our new bookEvent to get the intellisense from typescript for the following step.</li>
<li><code>type BookEvent</code> is a union type.</li>
</ul>
<pre><code>type BookEventUpdateGlobalMult = {
  index: number;
  type: 'updateGlobalMult';
  globalMult: number;
};

export type BookEvent =
  | ...
  | BookEventUpdateGlobalMult
  | ...
;
</code></pre>
<ul>
<li><code>src/game/bookEventHandlerMap.ts</code>: This file includes all the bookEventHandlers. Let's add a new one for the new bookEvent. Check the intellisense that the previous step brings, it provides a better developer experience.</li>
</ul>
<p><img alt="" src="../book_event_intellisense.png" /></p>
<!-- <img src="book_event_intellisense.png" alt="isolated" width="100%"/> -->

<h3 id="_4"></h3>
<ul>
<li><code>src/components/GlobalMultiplier.svelte</code>: This file is created as our target svelte component for updateGlobalMulti bookEvent. Technically speaking, all the jobs that's related to global multiplier of the game should only be in this svelte component. Similar to the bookEvent types, let's add the typescript types for new emitterEvents first.</li>
<li><code>type GlobalMultiplierEmitterEvent</code> is a union type.</li>
</ul>
<pre><code>&lt;script lang=&quot;ts&quot; module&gt;
  export type GlobalMultiplierEmitterEvent =
    | { type: 'globalMultiplierShow' }
    | { type: 'globalMultiplierHide' }
    | { type: 'globalMultiplierUpdate'; multiplier: number };
&lt;/script&gt;
</code></pre>
<ul>
<li><code>src/game/typesEmitterEvent.ts</code>: This file has typescript types of all the emitterEvents of the game. Let's add the type of our new emitterEvents for intellisense.</li>
<li><code>type GameEmitterEvent</code> is a union type.</li>
</ul>
<pre><code>...
import type { GlobalMultiplierEmitterEvent } from '../components/GlobalMultiplier.svelte';
...

export type GameEmitterEvent =
  | ...
  | GlobalMultiplierEmitterEvent
  | ...
;
</code></pre>
<ul>
<li><code>src/components/GlobalMultiplier.svelte</code>: Back to our component file, the intellisense is there. Let's add the code to process the values with a spine animation as well.</li>
</ul>
<p><img alt="" src="../emitter_event_intellisense.png" /></p>
<!-- <img src="emitter_event_intellisense.png" alt="isolated" width="100%"/> -->

<h3 id="_5"></h3>
<pre><code>&lt;script lang=&quot;ts&quot; module&gt;
  export type GlobalMultiplierEmitterEvent =
    | { type: 'globalMultiplierShow' }
    | { type: 'globalMultiplierHide' }
    | { type: 'globalMultiplierUpdate'; multiplier: number };
&lt;/script&gt;

&lt;script lang=&quot;ts&quot;&gt;
  ...

  context.stateApp.eventEmitter.registerOnMount({
    // emitterEventHandlerMap
    globalMultiplierShow: () =&gt; (show = true),
    globalMultiplierHide: () =&gt; (show = false),
    globalMultiplierUpdate: async (emitterEvent) =&gt; {
      console.log(emitterEvent.multiplier)
    },
  });
&lt;/script&gt;

&lt;SpineProvider key=&quot;globalMultiplier&quot; width={PANEL_WIDTH}&gt;
  ...
  &lt;SpineTrack trackIndex={0} {animationName} /&gt;
&lt;/SpineProvider&gt;
</code></pre>
<ul>
<li><code>Test</code>: Run <code>pnpm run storybook --filter=&lt;MODULE_NAME&gt;</code> in the terminal. We should see this:</li>
</ul>
<p><img alt="" src="../storybook_add_new_book_event.png" /></p>
<!-- <img src="storybook_add_new_book_event.png" alt="isolated" width="100%"/> -->

<h3 id="_6"></h3>
<ul>
<li>Now click on the <code>Action</code> button and we should see the <code>&lt;GlobalMultiplier /&gt;</code> animates correctly followed by the "Action is resolved" message, otherwise we need to go back to the component and figure out what's wrong until it's resolved.</li>
</ul>
<p><img alt="" src="../storybook_action_resolved.png" /></p>
<!-- <img src="storybook_action_resolved.png" alt="isolated" width="200"/> -->

<h3 id="_7"></h3>
<ul>
<li>If you find out the component hard to debug, we'd better start creating <code>COMPONENTS/&lt;GlobalMultiplier&gt;/component</code> or something even more lower level like <code>COMPONENTS/&lt;GlobalMultiplierSpine&gt;/component</code>. For which <code>&lt;GlobalMultiplierSpine /&gt;</code> component takes props instead of being controlled by emitterEvents. It's more friendly to test the component with the storybook controls.</li>
</ul>
<h2 id="to-be-continued">To Be Continued</h2>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>